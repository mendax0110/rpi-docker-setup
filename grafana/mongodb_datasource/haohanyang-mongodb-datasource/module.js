/* [create-plugin] version: 5.3.10 */
define(["@grafana/data","@grafana/runtime","@grafana/ui","module","react","rxjs"],((e,t,r,n,o,a)=>(()=>{"use strict";var i={781:t=>{t.exports=e},531:e=>{e.exports=t},7:e=>{e.exports=r},308:e=>{e.exports=n},959:e=>{e.exports=o},269:e=>{e.exports=a}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return i[e](r,r.exports,u),r.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var r in t)u.o(t,r)&&!u.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="public/plugins/haohanyang-mongodb-datasource/";var c={};u.r(c),u.d(c,{plugin:()=>je});var s=u(308),p=u.n(s);u.p=p()&&p().uri?p().uri.slice(0,p().uri.lastIndexOf("/")+1):"public/plugins/haohanyang-mongodb-datasource/";var f,g=u(781),d=u(531),m=window,y=Object.defineProperty,b={debug:!1},v=console.log,h=console.warn;function w(e){b.debug&&(v("[DEBUG]"),E(e)?h(e):v(e))}if(m.Reflect)f=Reflect.apply;else{var O=Function.prototype.apply;f=function(e,t,r){return O.call(e,t,r)}}var j=String.prototype.replace;function E(e){return!!e&&"object"==typeof e}var S=Object.assign,P=Object.keys;function _(){var e,t=params,r=t[0],n=t[1],o=t[2],a=t[3];try{for(var i=arguments,l=[],u=0,c=i.length;u<c;++u){var s=a.getWrappedValue(o,i[u],r,a);l.push(s)}e=a.apply(n,o.globalObject,l)}catch(e){throw a.wrapError(e,r)}return a.getWrappedValue(r,e,o,a)}S||(S=function(e){for(var t=arguments,r=1,n=t.length;r<n;++r){var o=t[r];if(E(o))for(var a=0,i=P(o);a<i.length;a++){var l=i[a];e[l]=o[l]}}return e});var x=Object.freeze({__proto__:null,GLOBAL:m,define:y,_:b,log:w,get apply(){return f},replace:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return f(j,e,t)},isObject:E,get assign(){return S},keys:P,wrapError:function(e,t,r){var n=t.intrinsics;if(void 0===r&&(r=!1),w(e),r){if(!e._)return new n[e.name](e.message);e=e._}var o=n.TypeError,a="Cross-Realm Error: ";return E(e)?new o(a+e.name+": "+e.message):new o(a+e)},getWrappedValue:function(e,t,r,n){if("function"==typeof t)try{return function(e,t,r,n){var o=t.length,a=t.name;("number"!=typeof o||o<0)&&(o=0),"string"!=typeof a&&(a="");var i=e.intrinsics.Function("params","return "+_.toString())(arguments);return y(i,"length",{value:o}),y(i,"name",{value:a}),i}(e,t,r,n)}catch(t){throw n.wrapError(t,e)}else if(E(t))throw new e.intrinsics.TypeError("need primitive or callable, got "+t);return t},globalReservedProps:["globalThis","Infinity","NaN","undefined","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","AggregateError","Array","ArrayBuffer","Atomics","BigInt","BigInt64Array","BigUint64Array","Boolean","DataView","Date","Error","EvalError","FinalizationRegistry","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","Proxy","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","Symbol","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakRef","WeakSet","Atomics","JSON","Math","Reflect","atob","btoa","console","crypto","Crypto","SubtleCrypto","TextDecoder","TextEncoder"]});function T(e,t){var r,n=e.globalObject,o=e.intrinsics,a=t.apply,i=t.define,l=t.GLOBAL,u=o.Array.prototype.push,c=o.Object.create,s=o.Promise,p=o.Symbol,f=l.fetch,g=l.URL,d=s.all,m=s.prototype.then,y={};function b(e){var r=y[e];if(r)return r.promise;var n=f(e,{credentials:"same-origin"}).then((function(t){if(200===t.status)return t.text();throw{_:new o.TypeError("Failed to fetch dynamically imported module: "+e)}})).then((function(r){for(var n=t.transformEsmSyntax(r),o=n[0],i=n[1],l=[],c=0,p=i.length;c<p;++c){var f=new g(i[c],e).href;i[c]=f,a(u,l,[b(f)])}var y=a(d,s,[l]);return a(m,y,[function(t){for(var r=0,n=t.length;r<n;++r)v(i[r],t[r]);return'var __meta={url:"'+e+'"};'+o}])}),(function(e){if(e._)throw e._;throw new o[e.name](e.message)}));return r=y[e]={promise:n},n}function v(e,t){r=c(null),p&&p.toStringTag&&i(r,p.toStringTag,{value:"Module"}),n.eval(t);var o=y[e];return o.exports=r,r=void 0,o.exports}i(n,"__import",{value:function(e,t){void 0===t&&(t=l.location.href);var r=new g(e,t).href;return new s((function(e,t){var n=y[r];if(n&&n.exports)return e(n.exports);b(r).then((function(t){e(v(r,t))})).catch(t)}))}}),i(n,"__from",{value:function(e,t){var r=new g(e,t).href,n=y[r];if(n&&n.exports)return n.exports;throw new o.Error("Module does not exist ("+e+")")}}),i(n,"__export",{set:function(e){return t.assign(r,e)}}),i(n,"__default",{set:function(e){return r.default=e}})}function q(e){var t,r=window,n=r.Function,o=r.Object,a=r.Symbol,i=o.getOwnPropertyNames,l=e.apply,u=e.define,c=e.dynamicImportPattern,s=e.dynamicImportReplacer,p=e.replace,f={},g={};a&&a.unscopables&&u(g,a.unscopables,{value:o.seal(o.create(null))});for(var d=0,m=i(r);d<m.length;d++){var y=m[d];f[y]=r[y];var b=-1!==e.globalReservedProps.indexOf(y),v=o.getOwnPropertyDescriptor(r,y);"eval"===y?E():b&&u(g,y,v),v.configurable?delete r[y]:v.writable?r[y]=t:b||u(g,y,{value:t})}if(f.EventTarget)for(var h=0,w=i(f.EventTarget.prototype);h<w.length;h++)"constructor"!==(y=w[h])&&u(r,y,{value:t});g.globalThis=g,g.Function=function(){var t=n.toString,o=function(){var o=l(n,null,arguments),a=l(t,o,[]);a='with(this)return function(){"use strict";return '+(a=p(a,c,s))+"}()",e.log(a);var i=n(a),u=l(i,g,[]);return function(){return l(u,this===r?void 0:this,arguments)}};return(o.prototype=n.prototype).constructor=o,o}();var O=n("with(this)return eval(arguments[0])"),j={intrinsics:f,globalObject:g,evalInContext:O};return e.defineShadowRealmCtor(j,e),e.addEsModuleHelpers(j,e),j;function E(){var t=!1,r=function(t){return t='"use strict";undefined;'+p(t,c,s),e.log(t),g.eval=f,l(O,g,[t])};u(g,"eval",{get:function(){return t?(t=!1,f.eval):r},set:function(e){t=e===f}})}}function D(e,t){var r=e.intrinsics.eval("("+I.toString()+")")(e,t);return t.define(r,"__debug",{get:function(){return t._.debug},set:function(e){return t._.debug=e}}),r}function I(e,t){var r=e.intrinsics,n=r.Function,o=r.Promise,a=r.String,i=r.Symbol,l=r.TypeError,u=t.apply,c=t.define,s=t.getWrappedValue,p=t.isObject,f=t.replace,g=t.wrapError,d=n.toString,m=function(){if(!(this instanceof m))throw new l("Constructor requires a new operator");var r=t.createRealmRecord(e,t);c(this,"__realm",{value:r})},y=m.prototype,b=!0;return c(y,"evaluate",{configurable:b,writable:b,value:function(r){var o,a=p(this)?this.__realm:{};if(!a.intrinsics)throw new l("must be called on ShadowRealm object");if("string"!=typeof r)throw new l("evaluate expects a string");try{o=function(e,r){e=f(e,t.dynamicImportPattern,t.dynamicImportReplacer),e=u(d,n(e),[]),e='"use strict";undefined;try'+f(e,/[^{]+/,"")+"catch(e){throw{_:e}}",t.log(e);var o=r.globalObject;return o.eval=r.intrinsics,u(r.evalInContext,o,[e])}(r,a)}catch(t){throw g(t,e,b)}return s(e,o,a,t)}}),c(y,"importValue",{configurable:b,writable:b,value:function(r,n){var i=p(this)?this.__realm:{};if(!i.intrinsics)throw new l("must be called on ShadowRealm object");if(r=a(r),"string"!=typeof n)throw new l("bindingName is not string");return new o((function(o,a){i.globalObject.__import(r).then((function(a){if(!(n in a))throw new l('"'+r+'" has no export named "'+n+'"');var u=s(e,a[n],i,t);o(u)})).catch((function(t){var r=g(t,e);a(r)}))}))}}),i&&i.toStringTag&&c(y,i.toStringTag,{configurable:b,value:"ShadowRealm"}),m}var F=[],C=[],R=/(^|[^.$])(\bimport\s*(\(|\/[/*]))/g,A=/([^\s,]+)\s+as\s+([^\s,]+)/g,M=[{p:RegExp("\\bexport\\b(\\s+((var|let|const)\\s+([^;]+)|(async\\s+)?function(\\s+|\\s*\\*\\s*)([^\\s(]+)|class\\s+([^\\s{]+)|default\\s+((async\\s+)?function(\\s+|\\s*\\*\\s*)([^\\s(]+)|class\\s+([^\\s{]+)|)?)|\\s*(\\*\\s*(as\\s+(\\S+)\\s+)?from\\s*(\"[^\"]+\"|'[^']+'|`[^`]+`)|{([^}]+)}(\\s*from\\s*(\"[^\"]+\"|'[^']+'|`[^`]+`))?))|\\bimport\\b(\\s*(({([^}]+)}\\s*|\\*\\s*as\\s+(\\S+)\\s+)from\\s*)?|\\s+([^{*\"'`]+)(\\s+from|\\s*,\\s*({([^}]+)}\\s*|\\*\\s*as\\s+(\\S+)\\s+)from)\\s*)(\"[^\"]+\"|'[^']+'|`[^`]+`)","g"),r:function(e,t,r,n,o,a,i,l,u,c,s,p,f,g,d,m,y,b,v,h,w,O,j,E,S,P,_,x,T,q,D,I){if(o){for(var R=0,M=o.split(",");R<M.length;R++)M[R].replace(/^\s*([^\s={}:]+)\s*($|=|})|[:{]\s*([^\s={}:]+)\s*($|=|})/,(function(e,t,r,n){return C.push(t||n),e}));return r}if(l)return"__export={"+l+":"+l+"};"+r;if(u)return C.push(u),r;if(f)return"__default="+f+";"+c;if(g)return C.push(g),r;if(r)return r.replace(/^default/,"__default=");if(b)return F.push(b),y?"__export={"+y+":__from("+b+",__meta.url)}":"__export=__from("+b+",__meta.url)";if(w){F.push(w);var L=[];return v.replace(/([^\s,]+)(\s+as\s+([^\s,]+))?/g,(function(e,t,r,n){return L.push((n||t)+":m."+t),e})),";(function(){var m=__from("+w+",__meta.url);__export={"+L.join()+"}}())"}if(v)return"__export={"+v.replace(A,"$2:$1")+"}";if(I){F.push(I);var B="=__from("+I+",__meta.url)";return S?"const{"+S.replace(A,"$1:$2")+"}"+B:P?"var "+P+B:q?"const{"+q.replace(A,"$1:$2")+"}"+B+","+_+B+".default":D?"var "+D+B+","+_+"="+D+".default":_?"var "+_+B+".default":I}}},{p:/\bimport\.meta\b/g,r:"__meta"},{p:R,r:"$1__$2"}],L=S({addEsModuleHelpers:function(e,t){e.intrinsics.eval("("+T.toString()+")")(e,t)},createRealmRecord:function(e,t){var r=e.intrinsics.document,n=r.createElement("iframe");return n.name="ShadowRealm",r.head.appendChild(n),n.contentWindow.eval("("+q.toString()+")")(t)},createShadowRealmCtor:D,defineShadowRealmCtor:function(e,t){t.define(e.globalObject,"ShadowRealm",{configurable:!0,writable:!0,value:D(e,t)})},dynamicImportPattern:R,dynamicImportReplacer:"$1__$2",transformEsmSyntax:function(e){for(var t=0,r=M;t<r.length;t++){var n=r[t],o=n.p,a=n.r;e=e.replace(o,a)}if(C.length){for(var i=C.length-1;i>=0;--i)C[i]+=":"+C[i];e+=";__export={"+C.join()+"}",C.length=0}for(var l=[],u=(i=0,F.length);i<u;++i){var c=F[i];l.push(c.substring(1,c.length-1))}return F.length=0,[e,l]}},x),B=m.ShadowRealm||D({intrinsics:m},L);function $(e){if(!e)return"Please enter the query text";try{const t=JSON.parse(e);return Array.isArray(t)?null:"Invalid query"}catch(e){return"Invalid query"}}function J(e){const t=e.trim().replace(/(;$)/g,"").replace(/(\r\n|\n|\r)/gm,"").match(/^db\.(.+)\.aggregate\((.+)\)$/);if(t){const e=t[1],r=t[2];return{jsonQuery:r,collection:e,error:$(r)}}return{error:"Invalid query"}}function N(e){const t=new B;try{const r=(0,d.getTemplateSrv)().replace(e);return{jsonQuery:t.evaluate(`\n            const fn = ${r}\n            const result = fn()\n            JSON.stringify(result)\n        `),error:null}}catch(e){return{error:null==e?void 0:e.message}}}function k(e){return JSON.stringify({$date:{$numberLong:e.toDate().getTime().toString()}})}function Q(e,t,r){let n=e.toDate().getTime();const o=t.toDate().getTime();let a=0;for(;n<o;)n+=r,a++;return a}function U(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n=0;for(;n<e;)t+=r.charAt(Math.floor(62*Math.random())),n+=1;return t}const V="timeseries",W="table",z="json",G="javascript",H="javascriptShadow",K={queryText:'[\n  {\n    "$limit": 10\n  }\n]',queryType:V,queryLanguage:z},X="auth-none",Y="auth-username-password",Z="standard",ee="dns_seed_list";var te=u(269);function re(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,o)}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ne(e,t,r[t])}))}return e}function ae(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class ie extends d.DataSourceWithBackend{getDefaultQuery(e){return K}applyTemplateVariables(e,t){return ae(oe({},e),{queryText:(0,d.getTemplateSrv)().replace(e.queryText,t)})}metricFindQuery(e,t){var r,n=this;return(r=function*(){var r,o;const a={requestId:"variable-query-"+U(3),targets:[{refId:"A",queryLanguage:z,collection:e.collection,queryText:(0,d.getTemplateSrv)().replace(e.queryText),queryType:"table"}],scopedVars:(null==t?void 0:t.scopedVars)||{},interval:"5s",timezone:"browser",intervalMs:5e3,range:(null==t?void 0:t.range)||{from:(0,g.dateTime)(),to:(0,g.dateTime)(),raw:{from:"now",to:"now"}},app:"variable-query",startTime:((null==t||null===(r=t.range)||void 0===r?void 0:r.from)||(0,g.dateTime)()).toDate().getUTCMilliseconds()},i=yield(0,te.firstValueFrom)(n.query(a));if((null===(o=i.errors)||void 0===o?void 0:o.length)&&i.errors.length>0)throw new Error(i.errors[0].message||"Unknown error");return function(e){const t=e.data[0].fields.find((e=>"value"===e.name));if(!t)throw new Error('Field "value" not found');if(t.type!==g.FieldType.string&&t.type!==g.FieldType.number)throw new Error("Each element should be string or number");return t.values.map((e=>({text:e.toString(),value:e,expandable:!0})))}(i)},function(){var e=this,t=arguments;return new Promise((function(n,o){var a=r.apply(e,t);function i(e){re(a,n,o,i,l,"next",e)}function l(e){re(a,n,o,i,l,"throw",e)}i(void 0)}))})()}filterQuery(e){return!!e.queryText&&!!e.collection}query(e){const t=e.targets.map((t=>{let r=t.queryText;if(t.queryLanguage===G||t.queryLanguage===H){const{jsonQuery:e}=t.queryLanguage===H?N(r):J(r);r=e}return ae(oe({},t),{queryText:r.replaceAll(/"\$from"/g,k(e.range.from)).replaceAll(/"\$to"/g,k(e.range.to)).replaceAll(/"\$dateBucketCount"/g,Q(e.range.from,e.range.to,e.intervalMs).toString())})}));return super.query(ae(oe({},e),{targets:t}))}constructor(e){super(e)}}var le=u(959),ue=u.n(le),ce=u(7);function se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){se(e,t,r[t])}))}return e}function fe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ge=[{label:"None",value:X},{label:"Username/Password",value:Y}],de=[{label:"mongodb",value:Z,description:"Standard Connection String Format"},{label:"mongodb+srv",value:ee,description:"DNS Seed List Connection Format"}];function me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){me(e,t,r[t])}))}return e}function be(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ve=[{label:"Time series",value:V},{label:"Table",value:W}];function he(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){he(e,t,r[t])}))}return e}function Oe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const je=new g.DataSourcePlugin(ie).setConfigEditor((function(e){const{onOptionsChange:t,options:r}=e,{jsonData:n,secureJsonFields:o,secureJsonData:a}=r;return n.authType||(n.authType=X),n.port||(n.port=27017),n.connectionStringScheme||(n.connectionStringScheme=Z),ue().createElement(ue().Fragment,null,ue().createElement(ce.Field,{label:"Connection string scheme"},ue().createElement(ce.RadioButtonGroup,{options:de,value:n.connectionStringScheme||Z,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{connectionStringScheme:e})}))}})),ue().createElement(ce.InlineFieldRow,{label:"Connection"},ue().createElement(ce.InlineField,{label:"Host",tooltip:"MongoDB host address"},ue().createElement(ce.Input,{required:!0,id:"config-editor-host",value:n.host,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{host:e.target.value})}))},width:30})),n.connectionStringScheme===Z&&ue().createElement(ce.InlineField,{label:"Port",tooltip:"MongoDB port"},ue().createElement(ce.Input,{id:"config-editor-port",value:n.port,type:"number",onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{port:e.target.valueAsNumber})}))},width:15,defaultValue:27017}))),ue().createElement(ce.InlineFieldRow,null,ue().createElement(ce.InlineField,{label:"Database",tooltip:"MongoDB database"},ue().createElement(ce.Input,{required:!0,id:"config-editor-database",value:n.database,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{database:e.target.value})}))},width:30}))),ue().createElement(ce.InlineField,{label:"Connection parameters",tooltip:"(Optional) Connection parameters appended to the connection string. For example retryWrites=true&w=majority&appName=default-cluster"},ue().createElement(ce.Input,{required:!0,id:"config-editor-connection-parameters",value:n.connectionParameters,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{connectionParameters:e.target.value})}))},width:35})),ue().createElement(ce.Divider,null),ue().createElement(ce.FieldSet,{label:"Authentication"},ue().createElement(ce.Field,{label:"Authentication method"},ue().createElement(ce.RadioButtonGroup,{options:ge,value:n.authType||X,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{authType:e})}))}}))),n.authType===Y&&ue().createElement(ue().Fragment,null,ue().createElement(ce.InlineField,{label:"Username",tooltip:"MongoDB username"},ue().createElement(ce.Input,{required:!0,id:"config-editor-username",value:n.username,onChange:e=>{t(fe(pe({},r),{jsonData:fe(pe({},n),{username:e.target.value})}))},width:35})),ue().createElement(ce.InlineField,{label:"Password",tooltip:"MongoDB password"},ue().createElement(ce.SecretInput,{required:!0,id:"config-editor-password",isConfigured:o.password,value:(null==a?void 0:a.password)||"",width:35,onReset:()=>{t(fe(pe({},r),{secureJsonFields:fe(pe({},r.secureJsonFields),{password:!1}),secureJsonData:fe(pe({},r.secureJsonData),{password:""})}))},onChange:e=>{t(fe(pe({},r),{secureJsonData:{password:e.target.value}}))}}))))})).setQueryEditor((function({query:e,onChange:t,onRunQuery:r}){const n=(0,le.useRef)(null),[o,a]=(0,le.useState)(null),i=[{label:"JSON",value:z},{label:"JavaScript",value:G,description:"javascript legacy"},{label:"JavaScriptShadow",value:H,description:"javascript with evaluation"}];return e.queryLanguage||(e.queryLanguage=K.queryLanguage),ue().createElement(ue().Fragment,null,ue().createElement(ce.InlineFieldRow,null,ue().createElement(ce.InlineField,{label:"Query Type"},ue().createElement(ce.Select,{id:"query-editor-query-type",options:ve,value:e.queryType||V,onChange:r=>{t(be(ye({},e),{queryType:r.value}))}})),ue().createElement(ce.InlineField,{label:"Collection",tooltip:"Enter the collection to query",error:"Please enter the collection",invalid:!e.collection},ue().createElement(ce.Input,{id:"query-editor-collection",onChange:r=>{t(be(ye({},e),{collection:r.target.value}))},value:e.collection,required:!0}))),ue().createElement(ce.Divider,null),ue().createElement(ce.InlineField,{label:"Query language"},ue().createElement(ce.Select,{id:"query-editor-use-js-query",onChange:(r,n)=>{t(be(ye({},e),{queryLanguage:r.value}))},options:i,value:e.queryLanguage})),ue().createElement(ce.Field,{label:"Query Text",description:`Enter the Mongo Aggregation Pipeline (${e.queryLanguage})`,error:o,invalid:null!=o},ue().createElement(ce.CodeEditor,{onEditorDidMount:e=>{n.current=e},width:"100%",height:300,language:e.queryLanguage===G||e.queryLanguage===H?"javascript":"json",onBlur:n=>{if(e.queryLanguage===G||e.queryLanguage===H){const{error:o,collection:i}=e.queryLanguage===H?N(n):J(n);t(ye(be(ye({},e),{queryText:n}),i?{collection:i}:{})),a(o),o||r()}else{t(be(ye({},e),{queryText:n}));const o=$(n);o||r(),a(o)}},value:e.queryText||"",showMiniMap:!1,showLineNumbers:!0,monacoOptions:{fontSize:14}})),ue().createElement(ce.Button,{onClick:()=>{n.current&&n.current.getAction("editor.action.formatDocument").run()}},"Format"))})).setQueryEditorHelp((function(e){return ue().createElement("div",null,ue().createElement(ce.Text,{element:"h1",color:"primary"},"Query Language Types and Differences"),ue().createElement(ce.Divider,null),ue().createElement("div",null,ue().createElement("p",null,ue().createElement(ce.Text,{element:"span",weight:"bold",color:"info"},"JSON"),": JSON aggregate of mongodb query."),ue().createElement("p",null,ue().createElement(ce.Text,{element:"span",weight:"bold",color:"info"},"JavaScript"),":JavaScript aggregate of mongodb query for the legacy support"),ue().createElement("p",null,ue().createElement(ce.Text,{element:"span",weight:"bold",color:"info"},"JavaScript Shadow"),": JavaScript function that return aggregate of mongodb query with evaluation support.")))})).setVariableQueryEditor((({onChange:e,query:t})=>{const[r,n]=(0,le.useState)(t),o=()=>{e(r,`${r.collection} (${r.queryText})`)};return ue().createElement(ue().Fragment,null,ue().createElement(ce.InlineField,{label:"Collection",tooltip:"Enter the MongoDB collection",error:"Please enter the collection",invalid:!t.collection},ue().createElement(ce.Input,{name:"collection",onChange:e=>n(Oe(we({},r),{collection:e.currentTarget.value})),value:r.collection})),ue().createElement(ce.Field,{label:"Query Text",description:"MongoDB aggregate (JSON)"},ue().createElement(ce.CodeEditor,{width:"100%",height:300,language:"json",onBlur:o,value:t.queryText||"",showMiniMap:!1,showLineNumbers:!0,onChange:e=>n(Oe(we({},r),{queryText:e})),monacoOptions:{fontSize:14}})),ue().createElement(ce.Alert,{title:"Query info",severity:"info"},"The query result is expected to contain ",ue().createElement("code",null,"value")," field which has elements of type ",ue().createElement("code",null,"string")," or ",ue().createElement("code",null,"number")),ue().createElement(ce.Button,{onClick:o,variant:"primary"},"Query"))}));return c})()));
//# sourceMappingURL=module.js.map